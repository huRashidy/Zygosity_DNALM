# Zygosity_DNALM

Zygosity-aware DNA language models leverage both haplotypes to improve ancestry and gene expression prediction. This repo provides HyenaDNA, CNNs, and Nucleotide Transformer-based code, embeddings generation, classification head training scripts, and example data to reproduce the study's key results.

## Table of Contents
- [Project Structure](#project-structure)
- [Folder Descriptions](#folder-descriptions)
- [Getting Started](#getting-started)
- [Usage](#usage)
- [Contributing](#contributing)

## Project Structure

```
Zygosity_DNALM/
├── src/            # Source code and model implementations
├── results/        # Output results and predictions
└── README.md       # This file
```

## Folder Descriptions


### `src/`
This directory contains all source code for the project:
- **Model Implementations**: HyenaDNA, CNNs, and Nucleotide Transformer architectures
- **Embedding Generation**: Scripts to generate DNA sequence embeddings
- **Classification Heads**: Code for training classification layers on top of embeddings
- **Data Processing**: Utilities for loading and preprocessing genomic data
- **Training Scripts**: End-to-end training pipelines
- **Evaluation Metrics**: Functions to compute model performance metrics
- **Figure Generation**: Code for generating each figure in the paper

### `results/`
This directory stores output files generated by the models:
- **Evaluation Metrics**: Accuracy, F1-scores, AUC-ROC curves in .csv and .npy

## Getting Started

Follow these steps to set up your environment, download the data, and run the training scripts for our DNA-LM zygosity-aware analysis.

1. Clone the Repository
bash
```
git clone https://github.com/huRashidy/Zygosity_DNALM.git`
cd Zygosity_DNALM
```
3. Download the Data from Zenodo
The full data archive (including all embeddings, .csv/.npy files, etc.) is available via Zenodo, with the link https://zenodo.org/records/17533617 .

a. Manual download:
Go to the Zenodo page and download the .rar (or .zip) file to your computer.

b. Command-line download:
You can use wget if a direct download link is available, or zenodo-get if preferred.

Example using wget (replace with the actual Zenodo download link and filename):

bash
```
wget https://zenodo.org/records/17533617/files/chr6.rar`
```
c. Extract the archive
Move the downloaded archive into your project directory and unpack:

bash
```
mkdir data
# If .rar (install unrar if needed)
unrar x chr6.rar data/
unrar x results.rar data/

```
All extracted data files must be placed in the data subfolder at the root of the repo.

3. Install Required Python Dependencies
Ensure you are using Python 3.8+ and run:

bash
pip install -r requirements.txt

### Prerequisites
- Matplotlib
- Seaborn
- pandas
- Numpy
- xgboost
- scikit-learn
```
## Citation

If you use this code in your research, please cite the corresponding paper (to be added).

## License

License information to be added.

## Contact

For questions or issues, please open an issue on GitHub or contact the repository maintainer.
