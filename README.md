# Zygosity_DNALM

Zygosity-aware DNA language models leverage both haplotypes to improve ancestry and gene expression prediction. This repo provides HyenaDNA, CNNs, and Nucleotide Transformer-based code, embeddings generation, classification head training scripts, and example data to reproduce the study's key results.

## Table of Contents
- [Project Structure](#project-structure)
- [Folder Descriptions](#folder-descriptions)
- [Getting Started](#getting-started)
- [Usage](#usage)
- [Contributing](#contributing)

## Project Structure

```
Zygosity_DNALM/
├── data/           # Data files and datasets
├── src/            # Source code and model implementations
├── results/        # Output results and predictions
├── test/           # Test files and test data
└── README.md       # This file
```

## Folder Descriptions

### `data/`
This directory contains all data files required for the project:
- **Genomic Data**: Raw and processed DNA sequences
- **Haplotype Information**: Phased haplotype data from both maternal and paternal chromosomes
- **Training Datasets**: Datasets used for training DNA language models
- **Ancestry Labels**: Population and ancestry annotation files
- **Gene Expression Data**: Expression levels associated with genetic variants

**Expected File Formats:**
- FASTA/FASTQ for sequence data
- VCF for variant data
- CSV/TSV for tabular data
- HDF5/NPY for preprocessed embeddings

### `src/`
This directory contains all source code for the project:
- **Model Implementations**: HyenaDNA, CNNs, and Nucleotide Transformer architectures
- **Embedding Generation**: Scripts to generate DNA sequence embeddings
- **Classification Heads**: Code for training classification layers on top of embeddings
- **Data Processing**: Utilities for loading and preprocessing genomic data
- **Training Scripts**: End-to-end training pipelines
- **Evaluation Metrics**: Functions to compute model performance metrics

**Key Components:**
- `models/`: Neural network architectures
- `utils/`: Helper functions for data processing and visualization
- `train.py`: Main training script
- `evaluate.py`: Model evaluation script
- `generate_embeddings.py`: Embedding extraction pipeline

### `results/`
This directory stores all output files generated by the models:
- **Predictions**: Model predictions on test datasets
- **Embeddings**: Extracted feature embeddings from DNA sequences
- **Evaluation Metrics**: Accuracy, F1-scores, AUC-ROC curves
- **Visualizations**: Plots, charts, and figures
- **Model Checkpoints**: Trained model weights and configurations
- **Logs**: Training logs and experiment tracking files

**Organization:**
- Organize by experiment name or timestamp
- Include metadata files describing each experiment
- Save both raw predictions and processed results

### `test/`
This directory contains all testing code:
- **Unit Tests**: Tests for individual functions and modules
- **Integration Tests**: End-to-end pipeline tests
- **Test Data**: Small sample datasets for testing
- **Validation Scripts**: Code to validate data integrity and model outputs

**Testing Framework:**
- Use pytest or unittest for Python tests
- Include test cases for data loading, model inference, and evaluation
- Ensure reproducibility with fixed random seeds

## Getting Started

### Prerequisites
- Python 3.8 or higher
- PyTorch (for deep learning models)
- Required packages listed in `requirements.txt` (to be added)

### Installation
```bash
# Clone the repository
git clone https://github.com/huRashidy/Zygosity_DNALM.git
cd Zygosity_DNALM

# Install dependencies (when requirements.txt is available)
# pip install -r requirements.txt
```

### Data Preparation
1. Place your genomic data files in the `data/` directory
2. Ensure haplotype phasing is complete for zygosity-aware analysis
3. Organize data according to the structure described above

## Usage

### Generating Embeddings
```bash
# Example command (to be implemented)
# python src/generate_embeddings.py --input data/sequences.fasta --output results/embeddings.npy
```

### Training Models
```bash
# Example command (to be implemented)
# python src/train.py --data data/training_set.csv --model hyenadna --output results/model_checkpoint
```

### Evaluating Models
```bash
# Example command (to be implemented)
# python src/evaluate.py --model results/model_checkpoint --test-data data/test_set.csv
```

### Running Tests
```bash
# Run all tests
# pytest test/

# Run specific test file
# pytest test/test_models.py
```

## Key Features

- **Zygosity-Aware Processing**: Leverages both maternal and paternal haplotypes for improved predictions
- **Multiple Architectures**: Supports HyenaDNA, CNNs, and Nucleotide Transformers
- **Flexible Pipeline**: Modular design allows easy integration of new models and data sources
- **Comprehensive Evaluation**: Built-in metrics for ancestry prediction and gene expression analysis

## Contributing

Contributions are welcome! Please follow these guidelines:
1. Fork the repository
2. Create a feature branch
3. Add tests for new functionality
4. Ensure all tests pass
5. Submit a pull request with a clear description

## Citation

If you use this code in your research, please cite the corresponding paper (to be added).

## License

License information to be added.

## Contact

For questions or issues, please open an issue on GitHub or contact the repository maintainer.
